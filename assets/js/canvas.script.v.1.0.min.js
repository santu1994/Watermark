function initCanvas(){$(".canvas-container").each(function(e){function t(e){[].forEach.call(f,function(e){e.classList.remove("img_dragging")}),this.classList.add("img_dragging");var t=$(this).offset();v=e.clientX-t.left,g=e.clientY-t.top}function n(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="copy",!1}function a(e){this.classList.add("over")}function i(e){this.classList.remove("over")}function r(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();var t=document.querySelector(".canvas-items img.img_dragging");console.log("event: ",e);var n=$(s).offset(),a=e.clientY-(n.top+g),i=e.clientX-(n.left+v),r=new fabric.Image(t,{width:t.width,height:t.height,left:i,top:a});return d.add(r),!1}function c(e){[].forEach.call(f,function(e){e.classList.remove("img_dragging")})}var o=$(this)[0],s=$("canvas",this)[0],d=window._canvas=new fabric.Canvas(s);d.setHeight(400),d.setWidth(380),d.setBackgroundColor("rgb(255,255,255)");var v,g,f=document.querySelectorAll(".canvas-items img");[].forEach.call(f,function(e){e.addEventListener("dragstart",t,!1),e.addEventListener("dragend",c,!1)}),o.addEventListener("dragenter",a,!1),o.addEventListener("dragover",n,!1),o.addEventListener("dragleave",i,!1),o.addEventListener("drop",r,!1)}),$(document).on("keyup",function(e){if(46==e.which){var t=_canvas.getActiveObject();t&&(_canvas.remove(t),_canvas.renderAll())}})}initCanvas();